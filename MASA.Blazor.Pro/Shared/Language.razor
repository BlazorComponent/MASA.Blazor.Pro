@inject GlobalConfigs GlobalConfig;
@inject LanguageConfig LanguageConfig
@inject I18n I18n

<MMenu OffsetY Bottom>
    <ActivatorContent>
        <div Color="white" @attributes="@context.Attrs" Class="hover-pointer ml-6 mr-5 neutral-lighten-4--text text-center">
            <MIcon>mdi-google-translate</MIcon>
        </div>
    </ActivatorContent>
    <ChildContent>
        <MList Class="py-0">
            <MListItemGroup ActiveClass="primary" Value="GlobalConfig.Language">
                @foreach (var languge in LanguageConfig.Languages)
                {
                    <MListItem OnClick="async()=> await OnLanguageChange(languge)" Value="(StringNumber)languge">
                        <ItemContent>
                            <MListItemContent>
                                <span Class="@(context.Active?"white--text":"neutral-lighten-4--text") text-btn">
                                    @LanguageMap(languge)
                                </span>
                            </MListItemContent>
                        </ItemContent>
                    </MListItem>
                }
            </MListItemGroup>
        </MList>
    </ChildContent>
</MMenu>

@code {

    [Parameter]
    public EventCallback Onchange { get; set; }

    async Task OnLanguageChange(string language)
    {
        GlobalConfig.Language = language;
        I18n.SetLang(language);
        await Onchange.InvokeAsync();
    }

    string LanguageMap(string language)
    {
        return language switch
        {
            "zh-CN" => "中文简体",
            "en-US" => "English",
            _ => "中文简体"
        };
    }
}
